var $xx=jQuery.noConflict(true);function Settings(a){$xx("head").append('<link rel="stylesheet" type="text/css" href="http://bnterprofiler.appspot.com/css/bnterprofile.min.css" />');this.Init=function(b){this.options=b};this.setSetting=function(c,b){this.options[c]=b;this.CreateStyles()};this.getSettings=function(){return this.options};this.CreateStyles=function(){var c="",b;c+="#bnterprofile{ width:"+this.options.width+";";c+="background:"+this.options.shell_background+";";c+="color:"+this.options.shell_color+";}";c+="#bnterprofile .message.left{ color:"+this.options.message_left_color+";}";c+="#bnterprofile .message.right{ color:"+this.options.message_right_color+";}";c+="#bnterprofile .conversation{background: "+this.options.conversation_background+";}";c+="#bnterprofile a{ color: "+this.options.link_color+"}";if($xx("#bnterprofile_styles").length>0){$xx("#bnterprofile_styles").remove()}b=$xx("<style id='bnterprofile_styles'>"+c+"<style />");$xx("head").append(b)};this.Init(a);this.CreateStyles()}function prettyDate(d){var b=new Date((d||"").replace(/-/g,"/").replace(/[TZ]/g," ")),c=(((new Date()).getTime()-b.getTime())/1000),a=Math.floor(c/86400);if(isNaN(a)||a<0||a>=31){return}return a==0&&(c<60&&"just now"||c<120&&"1 minute ago"||c<3600&&Math.floor(c/60)+" minutes ago"||c<7200&&"1 hour ago"||c<86400&&Math.floor(c/3600)+" hours ago")||a==1&&"Yesterday"||a<7&&a+" days ago"||a<31&&Math.ceil(a/7)+" weeks ago"}function unixToPrettyDate(a){var b,f,g,e,h,c,i,d;b=new Date(a*1000);f=b.getFullYear();g=b.getDate();e=b.getMonth()+1;h=b.getHours();c=b.getMinutes();i=b.getSeconds();d=f+"-"+e+"-"+g+"T"+h+":"+c+":"+i+"Z";return prettyDate(d)}function Message(h,e){var g,c,a,b,d,f;g=h.text;c=h.sender;a=c===e;b=75;d=h.profile_image_url.replace("?s=400","?s="+b);f='<div class="message '+(a?"left":"right")+'" >';f+='<div class="top"></div>';f+='<div class="middle"><span class="content">'+g+"</span></div>";f+='<div class="bottom"></div>';f+="</div>";f+='<div class="clear"></div>';this.getHTML=function(){return f}}function Messages(d,b){var a,c;a=[];c="";$xx.each(d,function(e,f){a[e]=new Message(f,b);c+=a[e].getHTML()});this.getHTML=function(){return c}}function User(d,a){var c,b,e;this.screen_name=d.screen_name;this.name=d.name;c=d.id>0;b=40;this.user_img=d.profile_image_url.replace("?s=400","?s="+b);this.getScreenNameHTML=function(){var f='<span class="username '+(a?"left":"right")+'">';if(c){f+='<a href="http://bnter.com/'+this.screen_name+'">'}f+=this.screen_name;if(c){f+="</a>"}f+="</span>";return f};this.getProfileImageHTML=function(){var f;f='<img class="profile_image '+(a?"left":"right")+'"';f+=' src="'+this.user_img+'" alt="sender" />';return f};this.getScreenName=function(){return this.screen_name}}function Conversation(i,l){var g,f,d,c,e,a,h,b,k,j;g=i.unix_timestamp;k=new User(i.user,true);f=k.getScreenName();e=k.getProfileImageHTML();a=k.getScreenNameHTML();j=new User(i.user_two,false);h=j.getProfileImageHTML();b=j.getScreenNameHTML();d=new Messages(i.messages,f);c='<div class="conversation">';c+=d.getHTML();c+='<div class="users">'+e+a+h+b+"</div>";c+='<div class="clear"></div>';c+='<span class="timestamp">'+unixToPrettyDate(g)+"</span>";c+="</div>";c=$xx(c);this.getHTML=function(){return c}}function Conversations(b){var g=b.username,d=b.count,e,a,f;a="http://bnterprofiler.appspot.com/bnter?user_screen_name="+g;if(document.URL.toLowerCase().indexOf("bnterprofiler.appspot.com")===-1){a+="&callback=?"}e=$xx('<div id="conversations"></div>');$xx.getJSON(a,function(c){$xx.each(c.conversations,function(h,i){if(h>=d){return}f=new Conversation(i);e.append(f.getHTML())})});return e}function BnterProfiler(a){var g,c,f,e,d,b;g=a.username;c=a.count;f=$xx("#bnterprofile");e="<div id='bnter_header'>";e+='<p id="username" class="left">';e+='<a href="http://www.bnter.com/'+g+'">'+g+"</a></p>";e+='<a id="bnter_header_link" href="http://www.bnter.com"><img alt="" src="http://bnter.com/web/assets/images/logo-small-2.png" class="right"></a>';e+='<div class="clear"></div></div>';d=$xx(e);b=new Conversations(a);f.append(d);f.append(b);this.settings=new Settings(a);this.setProperty=function(i,h){this.settings.setSetting(i,h)};this.getProperties=function(){return this.settings.getSettings()}};